<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="pt" lang="pt">
<head>
<title>htmlstaff.org - Informação para todos!</title>
<meta name="description" content="Site com conteúdo voltado à desenvolvedores, programadores e designers. Com tópicos relacionados a Informática, Internet e Tecnologia. Com artigos, tutoriais e dicas, apostilas, manuais, serviços gratuitos, além de entrevistas, notícias em geral, notícias sobre vírus e muito mais! Confira e comprove!" />
<meta name="keywords" content="desenvolvimento, criação, programação, webmasters, webdesigners, informática, internet, tecnologia, artigos, dicas, tutoriais, notícias, vírus, ajax, asp, asp.net, banco de dados, cgi, clipper, cold fusion, coreldraw, css, dhtml, dreamweaver, e-business, fireworks, flash, ftp, html, java, javascript, jsp, linux, lua, montagem e manutenção, msp, perl, photoshop, php, redes, scripting, soap, unix, visual basic, vrml, wap, wml, xhtml, xml, manuais, referência, serviços, contador, criptografador, formmail, gerador de janela popup, gerador de meta tags, recomendar o site" />
<meta http-equiv="content-type" content="text/html; charset=iso-8859-1" />
<meta http-equiv="pragma" content="no-cache" />
<meta name="title" content="htmlstaff.org" />
<meta name="url" content="http://www.htmlstaff.org" />
<meta name="copyright" content="Conteúdo sob licença Creative Commons 2.5" />
<meta name="language" content="pt-br" />
<meta name="rating" content="general" />
<meta name="robots" content="all" />
<meta name="revisit-after" content="1 days" />
<meta name="generator" content="Bloco de notas" />
<meta name="doc-class" content="Completed" />
<meta name="doc-rights" content="Public" />
<link rel="start" href="http://www.htmlstaff.org" type="text/html" title="Página inicial" />
<link rel="copyright" href="http://creativecommons.org/licenses/by-nc-sa/2.5/br/deed.pt" type="text/html" title="Conteúdo sob licença Creative Commons" />
<link rel="stylesheet" href="style.css" type="text/css" />
<link rel="alternate" type="application/rss+xml" title="RSS" href="http://www.htmlstaff.org/rss.php" />
<style type="text/css">
body {
	margin-left: 0px;
	margin-top: 0px;
	margin-right: 0px;
	margin-bottom: 0px;
	color: #000000;
	font-size: 12px;
        font-family: Arial, Helvetica, sans-serif;
}

table, 
tr, 
td {
	color: #000000;
	font-size: 12px;
        font-family: Arial, Helvetica, sans-serif;
}

td.header {
	color: #000000;
	font-size: 12px;
        font-family: Arial, Helvetica, sans-serif;
	background-color: #EEEEEE;
}

td.logo {
	color: #000000;
	font-size: 12px;
        font-family: Arial, Helvetica, sans-serif;
	background-color: #EEEEEE;
}

td.banner {
	color: #000000;
	font-size: 12px;
        font-family: Arial, Helvetica, sans-serif;
	background-color: #EEEEEE;
}

td.button {
	color: #000000;
	font-size: 12px;
        font-family: Arial, Helvetica, sans-serif;
	background-color: #EEEEEE;
}

td.null {
	color: #000000;
	font-size: 12px;
        font-family: Arial, Helvetica, sans-serif;
	background-color: #EEEEEE;
}

td.menu_esquerdo {
	color: #000000;
	font-size: 12px;
        font-family: Arial, Helvetica, sans-serif;
	background-color: #EEEEEE;
}

td.menu_direito {
	color: #000000;
	font-size: 12px;
        font-family: Arial, Helvetica, sans-serif;
	background-color: #EEEEEE;
}

td.principal {
	color: #000000;
	font-size: 12px;
        font-family: Arial, Helvetica, sans-serif;
	background-color: #FFFFFF;
}

td.footer {
	color: #000000;
	font-size: 12px;
        font-family: Arial, Helvetica, sans-serif;
	text-align: center;
	background-color: #EEEEEE;
}

#powered {
	color: #000000;
	font-size: 12px;
        font-family: Arial, Helvetica, sans-serif;
	text-align: center;
}

h1.titulo {
	color: #000000;
	font-size: 12px;
        font-family: Arial, Helvetica, sans-serif;
	font-weight: bold;
	text-align: center;
}

form {
	display: inline;
	margin: 0;
	padding: 0;
}

img {
	border: 0;
}

a:link, 
a:visited, 
a:active {
	background: transparent;
	color: #000000;
	text-decoration: underline;
}

a:hover {
	background: transparent;
	color: #000000;
	text-decoration: none;
	background-color: #EEEEEE;
}

a:link.menu, 
a:visited.menu, 
a:active.menu {
	background: transparent;
	color: #000000;
	text-decoration: none;
}

a:hover.menu {
	background: transparent;
	color: #000000;
	text-decoration: none;
	background-color: #CCCCCC;
}

a:link.static, 
a:visited.static, 
a:active.static {
	background: transparent;
	color: #000000;
	text-decoration: none;
}

a:hover.static {
	background: transparent;
	color: #000000;
	text-decoration: none;
}

a:hover.transparente {
	background: transparent;
	color: #000000;
	text-decoration: none;
}

input, 
textarea, 
select, 
button {
	background: #FFFFFF;
	border: 1px solid #999999;
	color: #000000;
	font-family: Arial, Helvetica, sans-serif;
	font-size: 12px;
	margin: 5px;
	padding: 2px;
	vertical-align: middle;
}

textarea {
	overflow: auto;
}

select {
	border: 0;
	font-family: Arial, Helvetica, sans-serif;
	font-size: 12px;
	margin: 0;
	padding: 0;
}

input.button {
	background: #EEEEEE;
	border: 1px solid #CCCCCC;
	color: #000000;
	font-family: Arial, Helvetica, sans-serif;
	font-size: 12px;
	margin: 5px;
	padding: 2px;
	vertical-align: middle;
}

input.radio {
	border: none;
}

input:focus, 
select:focus, 
textarea:focus {
	background: #EEEEEE;
	color: #000000;
}

pre {
	color: #000000;
	font-size: 12px;
        font-family: Arial, Helvetica, sans-serif;
	background-color: #F7F7F7;
	margin: 0;
	width: 600px;
	overflow: auto;
}

hr {
	color: #EEEEEE;
}

hr.menu {
	color: #CCCCCC;
}


ol {
	margin: 0em 0 0em 0px;
}

ol.li {
	color: #000000;
	font-size: 12px;
        font-family: Arial, Helvetica, sans-serif;
}

ul {
	margin: 0em 0 0em 0px;
}

ul.li {
	color: #000000;
	font-size: 12px;
        font-family: Arial, Helvetica, sans-serif;
}

blockquote {
	color: #000000;
	font-size: 12px;
        font-family: Arial, Helvetica, sans-serif;
	border-left: 10px solid #F7F7F7;
	margin: 0px;
	padding: 0px;
	padding-left: 25px;
}

div.moldura {
	color: #000000;
	font-size: 12px;
        font-family: Arial, Helvetica, sans-serif;
	border-left: 10px solid #F7F7F7;
	border-bottom: #F7F7F7 medium solid;
	border-left: #F7F7F7 medium solid;
	border-right: #F7F7F7 medium solid;
	border-top: #F7F7F7 medium solid;
}
</style>
<script type="text/javascript">
window.defaultStatus = "htmlstaff.org";
</script>
</head>
<body>
<div class="principal">
<p class="simpleText">Impresso através do site http://www.htmlstaff.org</p><br /><hr />Gerando documentos PDF com a classe FPDF<br /><br />O FPDF &eacute; uma classe para PHP de grande utilidade no processo de cria&ccedil;&atilde;o de relat&oacute;rios em formato PDF, utilizando fun&ccedil;&otilde;es simples e poderosas. O FPDF &eacute; um Software Livre (e gratuito), o que significa que voc&ecirc; poder&aacute; utiliz&aacute;-lo livremente para uso pessoal ou comercial, al&eacute;m de poder modific&aacute;-lo e estudar seu c&oacute;digo-fonte, ao contr&aacute;rio da PDFlib, que exige o pagamento de licen&ccedil;as para uso comercial.<br />
<br />
O FPDF possui suporte &agrave;s principais fun&ccedil;&otilde;es para gera&ccedil;&atilde;o de relat&oacute;rios, como por exemplo:<br />
<br />
. Formata&ccedil;&atilde;o de cabe&ccedil;alho (Header) e rodap&eacute; (Footer); <br />
. Quebra de p&aacute;gina autom&aacute;tica; <br />
. Quebra de linha e justifica&ccedil;&atilde;o de texto autom&aacute;tica; <br />
. Suporte a imagens (JPEG e PNG); <br />
. Suporte a fontes TrueType e Type1.<br />
<br />
Instalando o FPDF<br />
<br />
Antes de mais nada, acesse o endere&ccedil;o <a href="http://www.fpdf.org" rel="nofollow" target="_blank">http://www.fpdf.org</a> e fa&ccedil;a o download da &uacute;ltima vers&atilde;o do FPDF. Depois, descompacte o arquivo (.zip ou .tgz) no diret&oacute;rio em que ficar&aacute; hospedado seu website.<br />
<br />
Primeiros passos<br />
<br />
Crie um arquivo com o nome de modelo.php, por exemplo, e adicione as seguintes linhas:<br />
<br />
&lt;?php<br />
define('FPDF_FONTPATH', 'font/');<br />
require('fpdfxxx/fpdf.php'); // onde xxx &eacute; a vers&atilde;o da FPDF<br />
$pdf = new FPDF();<br />
$pdf-&gt;Open();<br />
$pdf-&gt;AddPage();<br />
$pdf-&gt;SetFont('Arial', 'B', 12);<br />
$pdf-&gt;Write(4, 'Ol&aacute; Mundo!!');<br />
$pdf-&gt;Output();<br />
?&gt;<br />
<br />
Agora vamos analisar cada linha:<br />
<br />
define('FPDF_FONTPATH','font/');<br />
<br />
Aqui voc&ecirc; define onde est&aacute; o diret&oacute;rio font/, criado na instala&ccedil;&atilde;o do FPDF. Esta linha &eacute; obrigat&oacute;ria.<br />
<br />
require('sub_diretorio/fpdf.php');<br />
<br />
Nesta linha voc&ecirc; informa onde est&aacute; o arquivo fpdf.php. &Eacute; neste arquivo que est&atilde;o todas as fun&ccedil;&otilde;es utilizadas neste artigo. Esta linha tamb&eacute;m &eacute; obrigat&oacute;ria.<br />
<br />
$pdf = new FPDF();<br />
<br />
Cria o objeto FPDF. Os valores default para p&aacute;gina s&atilde;o: tamanho A4 e no modo Retrato, com as medidas em mil&iacute;metros (mm). A sintaxe da fun&ccedil;&atilde;o FPDF() &eacute;:<br />
<br />
FPDF([String Orienta&ccedil;&atilde;o [,String Unidade [,mixed formato]]]);<br />
<br />
O par&acirc;metro Orienta&ccedil;&atilde;o pode ser preenchido com:<br />
<br />
. P: Portrait (Retrato) ou;<br />
. L: Landscape (Paisagem).<br />
<br />
Em Unidade podemos informar os valores:<br />
<br />
. pt: para pontos; <br />
. mm: para mil&iacute;metros; <br />
. cm: para cent&iacute;metros ou;<br />
. in: para polegadas.<br />
<br />
E em Formato:<br />
<br />
. A3;<br />
. A4;<br />
. A5;<br />
. Letter;<br />
. Legal.<br />
<br />
$pdf-&gt;Open();<br />
<br />
Inicia um novo documento PDF.<br />
<br />
$pdf-&gt;AddPage();<br />
<br />
Adiciona uma p&aacute;gina ao documento, com o cursor a 1cm de dist&acirc;ncia da margem esquerda e 1cm de dist&acirc;ncia da margem superior;<br />
<br />
$pdf-&gt;SetFont('Arial','B',12);<br />
<br />
Aqui a Fonte &eacute; definida como Arial, tamanho 12 e em negrito. A sintaxe da fun&ccedil;&atilde;o SetFont() &eacute;:<br />
<br />
SetFont(string fam&iacute;lia [,string Estilo [,float tamanho]]);<br />
<br />
Onde a fam&iacute;lia pode ser:<br />
<br />
. Courier;<br />
. Helvetica ou Arial;<br />
. Times;<br />
. Symbol ou;<br />
. ZapfDingbats.<br />
<br />
Estilo pode receber os valores:<br />
<br />
. Vazio : Normal (sem formata&ccedil;&atilde;o);<br />
. B: Negrito;<br />
. I: It&aacute;lico ou;<br />
. U: Sublinhado.<br />
<br />
$pdf-&gt;Write(4,'Ol&aacute; Mundo!!');<br />
<br />
Imprime algum texto no documento. Neste caso, &quot;Ol&aacute; Mundo!!&quot;. A sintaxe da fun&ccedil;&atilde;o Write() &eacute;:<br />
<br />
Write(float altura_da_linha, string texto [, mixed link]);<br />
<br />
O par&acirc;metro link deve receber uma URL ou um identificador retornado pela fun&ccedil;&atilde;o AddLink(). N&atilde;o veremos essa fun&ccedil;&atilde;o neste artigo, pois o seu prop&oacute;sito &eacute; criar relat&oacute;rios din&acirc;micos para impress&atilde;o ou armazenagem.<br />
<br />
$pdf-&gt;Output();<br />
<br />
Cria o arquivo PDF. Se o navegador tiver o plugin Adobe Acrobat Reader instalado, o documento ser&aacute; aberto pelo pr&oacute;prio navegador. Caso contr&aacute;rio, ele pedir&aacute; para fazer o download do PDF gerado.<br />
<br />
Criando algo realmente &uacute;til<br />
<br />
At&eacute; agora n&atilde;o foi mostrado nem um pouco do poder do PHP para criar relat&oacute;rios din&acirc;micos. A brincadeira come&ccedil;a a ficar interessante quando adicionamos fun&ccedil;&otilde;es relacionadas a banco de dados, e &eacute; exatamente isso que vamos fazer agora.<br />
<br />
Vou mostrar como criar um pdf com dados vindos de uma tabela MySQL. Antes de continuar, crie no MySQL uma tabela chamada vendas com os campos codvendas, produto, quantidade e valorunit. N&atilde;o esque&ccedil;a de inserir alguns registros na tabela antes de continuar.<br />
<br />
Crie o arquivo modelo2.php com as linhas:<br />
<br />
&lt;?php<br />
define('FPDF_FONTPATH', 'font/');<br />
require('sub_diretorio/fpdf.php');<br />
<br />
// bd.php deve conter as fun&ccedil;&otilde;es para se conectar no banco de dados<br />
include(&quot;bd.php&quot;);<br />
// busca os dados no banco de dados<br />
$busca = mysql_query(&quot;SELECT * FROM vendas WHERE Vendedor = 'Leandro'&quot;);<br />
$pdf = new FPDF();<br />
$pdf-&gt;Open();<br />
$pdf-&gt;AddPage();<br />
$pdf-&gt;SetFont('Arial', 'B', 10);<br />
$pdf-&gt;Cell(40, 5, 'C&oacute;digo da Venda');<br />
$pdf-&gt;SetX(35);<br />
$pdf-&gt;Cell(60, 5, 'Produto');<br />
$pdf-&gt;SetX(50);<br />
$pdf-&gt;Cell(40, 5, 'Quantidade');<br />
$pdf-&gt;SetX(77);<br />
$pdf-&gt;Cell(40, 5, 'Valor Unit&aacute;rio');<br />
while ($resultado = mysql_fetch_array($busca)) {<br />
    $pdf-&gt;ln();<br />
    $pdf-&gt;Cell(40, 5, $resultado['codvenda']);<br />
    $pdf-&gt;SetX(35);<br />
    $pdf-&gt;Cell(60, 5, $resultado['produto']);<br />
    $pdf-&gt;SetX(50);<br />
    $pdf-&gt;Cell(40, 5, $resultado['quantidade']);<br />
    $pdf-&gt;SetX(77);<br />
    $pdf-&gt;Cell(40, 5, $resultado['valorunit']);<br />
}<br />
$pdf-&gt;Output();<br />
?&gt;<br />
<br />
Neste exemplo vamos ter como resultado uma tabela sem bordas e com quatro campos: C&oacute;digo da Venda, Produto, Quantidade e Valor Unit&aacute;rio, com todas as vendas realizadas pelo vendedor Leandro. Analisando o c&oacute;digo, podemos notar que foram usadas tr&ecirc;s novas fun&ccedil;&otilde;es.<br />
<br />
S&atilde;o elas:<br />
<br />
ln()<br />
<br />
Quebra a linha. Sua sintaxe &eacute;: ln(float valor);<br />
<br />
Onde o &quot;valor&quot;, em mil&iacute;metros, &eacute; o tamanho do espa&ccedil;amento entre as linhas do texto. Se n&atilde;o for especificado um valor, ele pegar&aacute; o mesmo da &uacute;ltima c&eacute;lula impressa.<br />
<br />
SetX()<br />
<br />
Muda o cursor para a coordenada em x desejada. SetX(float coordenada);<br />
<br />
Cell()<br />
<br />
Cria uma c&eacute;lula de tamanho, texto, borda e alinhamento configurados pelo programador. Sintaxe:<br />
<br />
Cell(float width [, float height [, string texto [, mixed borda [, int ln [, string alinhamento [, int fill [, mixed link]]]]]]])<br />
<br />
Onde width &eacute; a largura e height, a altura da c&eacute;lula. Al&eacute;m destes par&acirc;metros, em texto informa-se o conte&uacute;do da c&eacute;lula. A op&ccedil;&atilde;o borda deve ser preenchida com 0, para retir&aacute;-la, ou 1 para colocar a borda. ln indica para onde vai o cursor ap&oacute;s a chamada da fun&ccedil;&atilde;o Cell(), e seus valores podem ser 0 para a direita, 1 para o come&ccedil;o da pr&oacute;xima linha e 2 para baixo.<br />
<br />
Alinhamento pode ser preenchido com L para a esquerda (default), C para centralizado e R para a direita. Em fill, devem-se informar os valores 0 para transparente (default) e 1 para preenchimento de fundo da c&eacute;lula. Em link, novamente poderia se utilizar a URL ou identificador retornado pela fun&ccedil;&atilde;o AddLink().<br />
<br />
Inserindo imagens no documento<br />
<br />
Para inserir imagens no relat&oacute;rio, devemos utilizar a fun&ccedil;&atilde;o Image(), explicada a seguir, em conjunto com as demais fun&ccedil;&otilde;es j&aacute; mostradas.<br />
<br />
Image(string arquivo, float x, float y, float w [, float h [, string Tipo [, mixed link]]])<br />
<br />
Onde arquivo &eacute; o nome do arquivo de imagem, x e y s&atilde;o as coordenadas da imagem no documento, w e h representam o tamanho da imagem em mil&iacute;metros (se omitido &eacute; utilizado o tamanho original da imagem).<br />
<br />
Tipo informa o formato da imagem (os seguintes formatos s&atilde;o v&aacute;lidos: jpg, jpeg, png). Se n&atilde;o especificado, esse valor ser&aacute; determinado a partir da extens&atilde;o do arquivo. Exemplo:<br />
<br />
$pdf-&gt;Image('logo.jpg',4,5,150,70,jpg);<br />
<br />
Adicione essa linha dentro do c&oacute;digo que gera o pdf, e ele inserir&aacute; a imagem logo.jpg nas coordenadas 4 em x e 5 em y, com o tamanho de 150x70mm no documento.<br />
<br />
Definindo o autor, criador e o t&iacute;iulo do relat&oacute;rio<br />
<br />
Para definir o autor do documento, utiliza-se a fun&ccedil;&atilde;o SetAuthor(), e sua sintaxe &eacute;: SetAuthor(string autor); onde autor &eacute; o nome do autor do documento.<br />
<br />
A fun&ccedil;&atilde;o SetCreator() define o criador do documento, com a sintaxe: SetCreator(string valor); onde valor &eacute; o nome do criador do documento. Normalmente utiliza-se o nome da ferramenta que o gerou.<br />
<br />
Para definir o t&iacute;tulo do documento criado, deve-se usar a fun&ccedil;&atilde;o SetTitle(), com a sintaxe: SetTitle(string nome_t). Onde nome_t &eacute; o t&iacute;tulo do documento.<br />
<br />
Com estas informa&ccedil;&otilde;es, j&aacute; &eacute; poss&iacute;vel criar um relat&oacute;rio com o texto formatado e dados fornecidos por tabelas de algum banco de dados, com o MySQL, o que torna muito mais pr&aacute;tica a cria&ccedil;&atilde;o do relat&oacute;rio, principalmente se ele utilizar uma grande quantidade de dados. Com a inser&ccedil;&atilde;o de imagens, tamb&eacute;m &eacute; poss&iacute;vel criar relat&oacute;rios personalizados utilizando a logo da empresa ou algum tipo de gr&aacute;fico, por exemplo.<br /><br />Autor/fonte:  Nivaldo Pereira de Arruda Neto<br />E-mail/Url:  http://www.phpbrasil.com/articles/article.php/id/802<br /><br />Enviado por xKuRt em 26/09/2006 às 09:31<hr /><p class="simpleText">Impresso através do site http://www.htmlstaff.org</p>
</div>
</body>
</html>